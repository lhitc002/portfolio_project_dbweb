<div class="create-story-container">
  <div class="create-story-header">
    <h1>Edit Story</h1>
    <p>Update your story details</p>
  </div>

  <% if (errors && errors.length > 0) { %>
  <div class="error-messages">
    <ul>
      <% errors.forEach(error => { %>
      <li><%= error %></li>
      <% }); %>
    </ul>
  </div>
  <% } %>
  <form action="../story/<%= formData.username %>/<%= formData.vanity %>/edit" method="POST" id="editStoryForm">
    <div class="form-group">
      <label for="title">Title <span class="required">*</span></label>
      <input type="text" id="title" name="title" class="form-control <%= errors && errors.some(e => e.includes('Title')) ? 'error' : '' %>" value="<%= formData.title %>" maxlength="150" required>
      <div class="character-count">
        <span id="titleCount">0</span>/150 characters
      </div>
    </div>

    <div class="form-group">
      <label for="synopsis">Synopsis <span class="required">*</span></label>
      <textarea id="synopsis" name="synopsis" class="form-control textarea <%= errors && errors.some(e => e.includes('Synopsis')) ? 'error' : '' %>" required><%= formData.synopsis %></textarea>
      <div class="form-help">A brief description of your story that will appear in listings</div>
    </div>

    <div class="button-group">
      <button type="submit" class="btn btn-primary">Save Changes</button>
      <a href="../story/<%= formData.username %>/<%= formData.vanity %>" class="btn btn-secondary">Cancel</a>
    </div>
  </form>
</div>

<script>
  // Character counters
  function updateCharacterCount(inputId, countId, maxLength) {
    const input = document.getElementById(inputId);
    const counter = document.getElementById(countId);

    function updateCount() {
      const length = input.value.length;
      counter.textContent = length;

      if (length > maxLength * 0.9) {
        counter.style.color = '#e74c3c';
      } else if (length > maxLength * 0.7) {
        counter.style.color = '#f39c12';
      } else {
        counter.style.color = '#666';
      }
    }

    input.addEventListener('input', updateCount);
    updateCount(); // Initial update
  }

  // Initialize character counters
  updateCharacterCount('title', 'titleCount', 150);
</script>