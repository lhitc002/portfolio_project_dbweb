<div class="auth-container">
  <h2>Create Your Account</h2>
  <div id="register-error" class="alert alert-error" style="display: none;"></div>

  <form id="register-form">
    <div class="form-group">
      <label for="username">Username</label>
      <input type="text" name="username" id="username" required>
    </div>
    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" name="email" id="email" required>
    </div>
    <div class="form-group">
      <label for="password">Password</label>
      <input type="password" name="password" id="password" required>
    </div>
    <div class="form-group">
      <label for="confirmPassword">Confirm Password</label>
      <input type="password" name="confirmPassword" id="confirmPassword" required>
    </div>
    <button type="submit" class="btn btn-primary">Register</button>
  </form>

  <p class="text-center">
    Already have an account? <a href=../auth/login">Log in</a>
  </p>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    $('#register-form').submit(async function(e) {
      e.preventDefault();
      $('#register-error').hide().text('');

      const formData = {
        username: $('#username').val(),
        email: $('#email').val(),
        password: $('#password').val(),
        confirmPassword: $('#confirmPassword').val()
      };

      try {
        const response = await $.ajax({
          url: '../api/auth/register',
          type: 'POST',
          contentType: 'application/json',
          data: JSON.stringify(formData)
        });

        if (response.success) {
          window.location.href = `../users/${response.user.username}`;
        } else {
          $('#register-error').text(response.error).show();
        }
      } catch (error) {
        const errMsg = error.responseJSON?.error || 'Registration failed';
        $('#register-error').text(errMsg).show();
      }
    });
  });
</script>